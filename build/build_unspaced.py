with open('ayaka_2021.dict.yaml') as f, open('ayaka_2021_unspaced.dict.yaml', 'w') as g:
    # Header
    for line in f:
        if line == '...\n':
            g.write(line)
            break
        else:
            # Override several configurations
            if line == '# encoding: utf-8\n':
                g.write(line)
                g.write('#\n# NOTICE: This file is auto-generated for reverse lookup.\n')
                g.write('# Do not edit this file directly!\n')
                g.write('# You should edit ayaka_2021.dict.yaml.\n')
            elif line == 'name: ayaka_2021\n':
                g.write('name: ayaka_2021_unspaced\n')
            elif line in \
                [ 'use_preset_vocabulary: true\n'
                , 'import_tables:\n'
                ] or line.startswith('  - '):
                pass
            else:
                g.write(line)

    # Dictionary
    for line in f:
        if line.startswith('#'):
            g.write(line)
        else:
            g.write(line.replace(' ', '='))
